<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.intellimarket.store.dao.StoreInfoDAO">

	<resultMap id="storeInfoMap" type="StoreInfo">
		<id column="store_info_id" property="storeInfoId" />
		<result column="store_name" property="storeName" />
		<result column="store_tel" property="storeTel" />
		<result column="logo_path" property="logoPath" />
		<result column="store_introduce" property="storeIntroduce" />
		<!-- Seller id로 association -->
		<association property="seller" javaType="Seller"
			column="seller_id"
			select="com.intellimarket.store.dao.SellerDAO.selectById" />
	</resultMap>

		<!-- 전체 목록 조회 -->
		<select id="selectAll" resultMap="storeInfoMap">
			SELECT * FROM store_info
		</select>

		<select id="selectById" parameterType="int" resultMap="storeInfoMap">
			SELECT * FROM store_info WHERE seller_id = #{sellerId}
		</select>
		
		<!-- 스토어 목록 최신 등록순 조회 -->
		<select id="selectRecentByCount" parameterType="int" resultMap="storeInfoMap">
			SELECT * FROM store_info 
			ORDER BY store_info_id DESC
			LIMIT #{count}
		</select>

		<insert id="insert" parameterType="StoreInfo">
			INSERT INTO
			store_info(store_name, store_tel, logo_path, seller_id,
			store_introduce)
			values (#{storeName}, #{storeTel}, #{logoPath}, #{seller.sellerId},
			#{storeIntroduce})
		</insert>

		<update id="update" parameterType="StoreInfo">
			UPDATE store_info SET
			store_name = #{storeName},
			store_tel = #{storeTel},
			store_introduce = #{storeIntroduce}
			Where seller_id =
			#{seller.sellerId}
		</update>

		<!-- 변경 -->
		<update id="updateLogo" parameterType="StoreInfo">
			update store_info
			set logo_path = #{logoPath}
			where seller_id = #{seller.sellerId}
		</update>

</mapper>